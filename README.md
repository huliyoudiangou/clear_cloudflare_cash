# Cloudflare 缓存清理脚本

这是一个用于清理 Cloudflare CDN 缓存的 Bash 脚本。

## 功能概述

- 清理单个页面缓存或全站缓存
- 管理多个 Cloudflare Zone ID 和对应域名
- 动态添加新的 Zone ID 和域名
- 自动保存和读取配置信息
- 更新 API Token
- 创建快捷命令别名
- 检查并显示缓存清理状态
- 选择清理特定 Zone 或所有 Zone 的缓存
- 编辑现有配置

## 使用指南

1. 确保您拥有 Cloudflare 账户的 Zone ID(s)、对应域名和 API Token。
2. 给脚本添加执行权限：
   ```
   chmod +x purge_cache.sh
   ```
3. 运行脚本：
   ```
   ./purge_cache.sh
   ```
4. 按照交互提示操作：
   - 首次运行时输入必要信息
   - 选择操作（添加新 Zone、编辑配置、清理缓存）
   - 选择要清理的 Zone（如有多个）
   - 选择清理类型（单个页面或全站）
   - 对于单个页面，输入要清除缓存的 URL
5. 脚本执行后，将显示缓存清理状态。
6. 可选择是否再次检查缓存状态。（注意：如果已经清理完毕就不用再次检查了，再次检查会再次缓存）

### 快捷调用方式

脚本首次运行后会自动创建一个别名 'c'，使用以下步骤启用并使用快捷调用：

1. 运行以下命令以启用别名：
   ```
   source ~/.bashrc
   ```
2. 之后，您可以直接使用以下命令运行脚本：
   ```
   c
   ```

注意：如果后续使用 C 无法调用，您可能需要再次运行 `source ~/.bashrc` 来启用别名。

## 注意事项

- 首次运行需要输入 Cloudflare 配置信息。
- 配置信息安全存储在用户主目录下的隐藏文件中。
- 提供 API Token 更新功能。
- 可创建快捷命令别名，提高使用便利性。
- 缓存清理效果可能不会立即显现，可能需要等待几分钟。
- 可以使用系统默认编辑器编辑配置文件。
- 全站缓存清除后，脚本会自动使用域名的根 URL（https://domain.com）来检查缓存状态。
- 单页面缓存清除后，脚本会使用用户提供的 URL 来检查缓存状态。

## 缓存状态解释

- HIT: 缓存命中，可能表示清理未完全生效。
- MISS: 缓存未命中，通常表示清理成功。
- DYNAMIC: 内容被标记为动态，不进行缓存。
- EXPIRED: 缓存已过期，通常意味着正在更新缓存。

## 贡献

欢迎通过 Issues 和 Pull Requests 为此脚本贡献改进意见和代码。

## 许可

本项目采用 MIT 许可证。
